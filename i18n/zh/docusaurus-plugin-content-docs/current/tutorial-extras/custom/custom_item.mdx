---
sidebar_position: 1
mentions:
  - "jlhsr"
  - "Mcayear"
---

# è‡ªå®šä¹‰ç‰©å“

æƒ³è¦åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ç‰©å“ï¼Œéœ€è¦åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š

1. æ’ä»¶å†…æˆåŠŸæ³¨å†Œåˆ° Nukkit-MOT
2. èµ„æºåŒ…å†…å®šä¹‰ç‰©å“è´´å›¾å‘é€ç»™å®¢æˆ·ç«¯

æ¥ä¸‹æ¥ä»¥ **ç³–æœå‰‘** ä¸ºä¾‹ï¼Œæ¼”ç¤ºè‡ªå®šä¹‰ç‰©å“çš„æ­¥éª¤ã€‚

## åœ¨æ’ä»¶ä¸­æ³¨å†Œç‰©å“ \{#register-item-in-plugin}

æˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹åºåˆ—å›¾è¿›è¡Œæ“ä½œ

```mermaid
sequenceDiagram
    participant Plugin
    participant ItemCustom
    participant CustomItemDefinition
    participant Item
    
    Plugin->>ItemCustom: åˆ›å»ºæ–°ç‰©å“ç±»å¹¶ç»§æ‰¿
    ItemCustom->>ItemCustom: é‡å†™getMaxStackSize()
    ItemCustom->>ItemCustom: é‡å†™scaleOffset()
    ItemCustom->>CustomItemDefinition: é‡å†™getDefinition()
    CustomItemDefinition->>CustomItemDefinition: ä½¿ç”¨æ„å»ºå™¨è®¾ç½®å±æ€§
    CustomItemDefinition-->>ItemCustom: è¿”å›CustomItemDefinition
    Plugin->>Item: registerCustomItem(æ–°ç‰©å“ç±»)
```

### åˆ›å»ºæ–°ç‰©å“çš„ç±» \{#creat-new-item-class}

åœ¨æ’ä»¶ä¸­ï¼Œæ–°å»º `CandyCaneSword` ç±»ï¼Œç»§æ‰¿ ItemCustom å¹¶é‡å†™ç›¸åº”æ–¹æ³•

```java title="custom/item/CandyCaneSword.java"
package cn.nukkitmot.exampleplugin.custom.item;

import cn.nukkit.item.customitem.CustomItemDefinition;
import cn.nukkit.item.customitem.ItemCustom;
import cn.nukkit.item.customitem.data.ItemCreativeCategory;
import cn.nukkit.item.customitem.data.ItemCreativeGroup;
import cn.nukkit.item.customitem.data.RenderOffsets;

public class CandyCaneSword extends ItemCustom {
    // highlight-start
    private static String spacenameId = "nukkit:candy_cane_sword";
    private static String textureName = "candy_cane_sword";
    private static String name = null;

    public CandyCaneSword() {
        super(spacenameId, name, textureName);
    }

    public int scaleOffset() {
        return 32; // éœ€è¦æ˜¯16çš„å€æ•°ï¼Œå¦‚ 32ã€64ã€128
    }

    /**
     * è¯¥æ–¹æ³•è®¾ç½®è‡ªå®šä¹‰ç‰©å“çš„å®šä¹‰
     */
    @Override
    public CustomItemDefinition getDefinition() {
        return CustomItemDefinition
                .simpleBuilder(this, ItemCreativeCategory.EQUIPMENT)
                .creativeGroup(ItemCreativeGroup.SWORD)
                .allowOffHand(true)
                .handEquipped(true)
                .renderOffsets(RenderOffsets.scaleOffset(scaleOffset()))
                .build();
    }

    @Override
    public int getMaxDurability() {
        return 500;
    }

    @Override
    public int getMaxStackSize() {
        return 1;
    }

    @Override
    public int getAttackDamage() {
        return 4;
    }

    @Override
    public boolean isSword() {
        return true;
    }
    // highlight-end
}
```

### ItemCustom ä¸»è¦æ–¹æ³• \{#key-methods-itemcustom}

å¼•è‡ª [cn.nukkit.item.customitem.ItemCustom](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/item/customitem/ItemCustom.java)

æˆ‘ä»¬éœ€è¦ç”¨ `@Override` æ¥é‡å†™ä¸‹é¢çš„æ–¹æ³•ã€‚

- `getMaxStackSize()`
æ–¹æ³•ç”¨äºè®¾ç½®è‡ªå®šä¹‰ç‰©å“çš„æœ€å¤§å †å æ•°é‡ã€‚

- `scaleOffset()`
æ–¹æ³•ç”¨äºè®¾ç½®è‡ªå®šä¹‰ç‰©å“çš„è´´å›¾å¤§å°ï¼Œè¿”å›å€¼éœ€è¦æ˜¯16çš„å€æ•°ï¼Œå¦‚ 32ã€64ã€128ã€‚

- `getDefinition()`
è¿”å›ä¸€ä¸ª CustomItemDefinition ç±»æ¦‚æ‹¬äº†è¯¥ç‰©å“çš„åŸºæœ¬å±æ€§ï¼Œå¦‚ æ˜¯å¦å…è®¸å‰¯æ‰‹ã€åœ¨åˆ›é€ æ çš„åˆ†ç±»ã€é™„é­”æ•ˆæœã€‚

### CustomItemDefinition ä¸»è¦æ–¹æ³• \{#key-methods-customitemdefinition}

å¼•è‡ª [cn.nukkit.item.customitem.CustomItemDefinition](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/item/customitem/CustomItemDefinition.java)

#### å¸¸ç”¨æ„å»ºå™¨  \{#common-builders}

- `customBuilder` è‡ªå®šä¹‰ç‰©å“çš„å®šä¹‰æ„é€ å™¨

- `simpleBuilder` ç®€å•ç‰©å“çš„æ„å»ºå™¨ ï¼ˆé»˜è®¤ä½¿ç”¨è¿™ä¸ªï¼‰

- `toolBuilder` å·¥å…·ç‰©å“çš„æ„å»ºå™¨

- `armorBuilder` ç›”ç”²ç‰©å“çš„æ„å»ºå™¨

- `edibleBuilder` é£Ÿå“çš„æ„å»ºå™¨

å…ˆä½¿ç”¨æ„å»ºå™¨è¿”å›ä¸€ä¸ª `CustomItemDefinition` ç±»

```java title="java"
CustomItemDefinition.simpleBuilder(ItemCustom item, ItemCreativeCategory creativeCategory);
```

#### å¸¸ç”¨æ–¹æ³• \{#common-methods}

ç”±äºæ–¹æ³•ç›´æ¥è¿”å› `this` å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‰å¹³åŒ–çš„å†™æ³•ã€‚

- `allowOffHand(boolean allowOffHand)` æ˜¯å¦å…è®¸å‰¯æ‰‹æŒæœ‰ã€‚

- `handEquipped(boolean handEquipped)` æ§åˆ¶ç¬¬ä¸‰äººç§°æ‰‹æŒç‰©å“çš„æ˜¾ç¤ºæ–¹å¼ã€‚

- `foil(boolean foil)` æ˜¯å¦æœ‰é™„é­”å…‰è¾‰æ•ˆæœï¼Œæ¯”å¦‚é™„é­”ä¹¦å°±æœ‰ã€‚

- `creativeGroup(ItemCreativeGroup creativeGroup)` æ§åˆ¶è‡ªå®šä¹‰ç‰©å“åœ¨åˆ›é€ æ çš„åˆ†ç»„ï¼Œä¾‹å¦‚æ‰€æœ‰çš„é™„é­”ä¹¦éƒ½æ˜¯ `ItemCreativeGroup.ENCHANTED_BOOK` ç»„ã€‚

- `canDestroyInCreative(boolean value)` æ§åˆ¶æ‹¿è¯¥ç‰©å“çš„ç©å®¶æ˜¯å¦å¯ä»¥åœ¨åˆ›é€ æ¨¡å¼æŒ–æ˜æ–¹å—ã€‚

### ItemCreativeGroup ä¸»è¦æ–¹æ³• \{#itemcreativegroup-key-methods}

å¼•è‡ª [cn.nukkit.item.customitem.data.ItemCreativeGroup](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/item/customitem/data/ItemCreativeGroup.java)

### æ³¨å†Œç‰©å“ \{#register-item}

æœ€åï¼Œåœ¨æ’ä»¶å…¥å£ç±»çš„ onEnable æ–¹æ³•ä¸­æ³¨å†Œç‰©å“

```java title="ExamplePlugin.java"
import cn.nukkit.item.Item;
import cn.nukkitmot.exampleplugin.custom.item.CandyCaneSword;

public class ExamplePlugin extends PluginBase {
    @Override
    public void onEnable() {
        // highlight-start
        Item.registerCustomItem(CandyCaneSword.class);
        // highlight-end
    }
}
```

## åˆ¶ä½œèµ„æºåŒ… \{#creating-resource-pack}

æ•™ç¨‹å°†æŒ‡å¯¼æ‚¨å¦‚ä½•åˆ¶ä½œèµ„æºåŒ…ï¼Œç¡®ä¿æ­£ç¡®æŒ‡å‘ç‰©å“è´´å›¾ï¼Œä»¥åœ¨æ¸¸æˆå†…æ­£ç¡®æ˜¾è‡ªå®šä¹‰ç‰©å“ã€‚

å¦‚æœåœ¨æ¸¸æˆå†…åˆ›é€ ç‰©å“æ ä¸­ä»ç„¶çœ‹åˆ°ç©ºç™½æ ¼å­ï¼Œè¯·æ£€æŸ¥èµ„æºåŒ…é…ç½®å’Œç‰©å“è´´å›¾è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚

è¯¦ç»†æ­¥éª¤åŒ…æ‹¬ï¼š

1. å®šä¹‰èµ„æºåŒ…çš„ UUID å’Œä¿¡æ¯ã€‚
2. åœ¨èµ„æºåŒ…ä¸­å®šä¹‰ç‰©å“è´´å›¾è·¯å¾„ã€‚
3. æ‰“åŒ…èµ„æºåŒ…å¹¶æ”¾å…¥æœåŠ¡å™¨çš„ resource_packs æ–‡ä»¶å¤¹ã€‚

### èµ„æºåŒ…ç›®å½•æ„æˆ \{#resource-pack-directory}

èµ„æºåŒ…ç›®å½•åº”è¯¥åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

```mermaid
graph TD;
    RP("ğŸ“ Resource Pack") --> manifest["ğŸ“„ manifest.json"];
    RP --> pack_icon["ğŸ“„ pack_icon.png"];
    RP --> textures("ğŸ“ textures");
    textures -..-> texture_list["ğŸ“„ texture_list.json"];
    textures --> item_texture["ğŸ“„ item_texture.json"];
    textures --> items("ğŸ“ items");
    items --> candy_cane_sword["ğŸ“„ candy_cane_sword.png"];
```

### manifest.json \{#manifest-json}

å‚è€ƒ Bedrock Wiki å¯¹ [RP Manifest](https://wiki.bedrock.dev/guide/project-setup.html#rp-manifest) çš„è®²è§£ã€‚

```json title="RP/manifest.json"
{
    "format_version": 2,
    "header": {
        "description": "BY.nukkit-mot",
        "name": "Â§7æµ‹è¯•èµ„æºåŒ…",
        "uuid": "00000000-0000-0000-0000-000020160300",
        "version": [1, 1, 6],
        "min_engine_version": [1, 14, 0]
    },
    "modules": [
        {
            "type": "resources",
            "uuid": "dde211f9-e1a6-435e-9a84-06fa9242f63e",
            "version": [1, 0, 0]
        }
    ]
}
```

### item_texture.json \{#item_texture-json}

```json title="RP/textures/item_texture.json"
{
    "resource_pack_name": "nukkit-mot",
    "texture_name": "atlas.items",
    "texture_data": {
        // highlight-start
        "candy_cane_sword": {
            "textures": "textures/items/candy_cane_sword"
        }
        // highlight-end
    }
}
```

æ‰“åŒ…å¥½èµ„æºåŒ…æ”¾å…¥æœåŠ¡å™¨çš„ `resource_packs` æ–‡ä»¶å¤¹ã€‚

è¿›å…¥æœåŠ¡å™¨ï¼Œæ­£å¸¸æƒ…å†µä¸‹æ‚¨ä¼šçœ‹è§èµ„æºåŒ…æ­£å¸¸æ˜¾ç¤ºã€‚

:::danger ç‰©å“æè´¨æœªèƒ½æ­£å¸¸æ˜¾ç¤ºï¼Ÿ

å¾ˆæŠ±æ­‰å¬åˆ°è¿™ä¸ªæ¶ˆæ¯ï¼Œä½†è¯·ä¿æŒå†·é™ã€‚å¹¶æŒ‰ä¸‹åˆ—æƒ…å½¢è¿›è¡Œæ’æŸ¥:

1. è‹¥éæ’ä»¶å†…ç½®èµ„æºåŒ…ï¼Œèµ„æºåŒ…æ‰“åŒ…æ—¶æ˜¯ä»¥æ ¹ç›®å½•å‹ç¼©çš„å—ï¼Ÿä¹Ÿå°±æ˜¯ç‚¹å¼€å‹ç¼©åŒ…å°±èƒ½çœ‹åˆ° `manifest.json` æ–‡ä»¶ã€‚

2. èµ„æºåŒ…åç¼€æ˜¯å¦ä» `.zip` æ”¹ä¸º `.mcpack` åç¼€ï¼Ÿé zip æ ¼å¼çš„å‹ç¼©ç®—æ³•å®¢æˆ·ç«¯ä¸æ”¯æŒã€‚

3. æ›´æ–°èµ„æºåŒ…åï¼Œæ˜¯å¦æœ‰æ¸…ç†å®¢æˆ·ç«¯ç¼“å­˜ï¼Ÿåœ¨ `è®¾ç½® â†’ å­˜å‚¨ â†’ èµ„æºåŒ…` å­˜æœ‰èµ„æºåŒ…ç¼“å­˜æ—¶ï¼Œå®¢æˆ·ç«¯ä¸ä¼šå‘æœåŠ¡å™¨è¯·æ±‚æ›´æ–°çš„èµ„æºåŒ…ã€‚

:::

## æ·±å…¥äº†è§£ \{#further-exploration}

### æ’ä»¶å†…ç½®èµ„æºåŒ… \{#resource_packs-in-plugin}

å¾—ç›Šäº Nukkit-MOT çš„è®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ’ä»¶å¼€å‘ä¸­éå¸¸æ–¹ä¾¿çš„ç¼–è¾‘èµ„æºåŒ…ã€‚

åªéœ€è¦åœ¨æ’ä»¶çš„ `resources` åˆ›å»º `assets/resource_pack` æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­æ”¾ç½®èµ„æºåŒ…ã€‚

æ¼”ç¤ºæ’ä»¶å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚

<details>
    <summary>
      å±•ç¤º [ExamplePlugin](https://github.com/MemoriesOfTime/ExamplePlugin-Maven/tree/master/src/main/resources) çš„ resources ç›®å½•ç»“æ„
    </summary>
```mermaid
graph TD;
    resources("ğŸ“ resources") --> assets("ğŸ“ assets");
    resources("ğŸ“ resources") --> pluginyml["ğŸ“„ plugin.yml"];
    resources("ğŸ“ resources") -..-> language("ğŸ“ language");
    assets("ğŸ“ assets") --> RP("ğŸ“ resource_pack");
    RP --> textures("ğŸ“ textures");
    textures -..-> texture_list["ğŸ“„ texture_list.json"];
    textures --> item_texture["ğŸ“„ item_texture.json"];
    textures --> items("ğŸ“ items");
    items --> candy_cane_sword["ğŸ“„ candy_cane_sword.png"];
    RP("ğŸ“ resource_pack") --> manifest["ğŸ“„ manifest.json"];
    RP --> pack_icon["ğŸ“„ pack_icon.png"];
```
</details>

### ä¸ Bedrock Wiki çš„å¯¹ç…§å…³ç³» \{#comparing-with-bedrock-wiki}

å¦‚æœ CustomItemDefinition ä¸­æ²¡æœ‰æ‚¨æƒ³è¦çš„å°è£…æ–¹æ³•ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

æˆ‘ä»¬å¯ä»¥ç›´æ¥å‚ç…§ Bedrock Wiki çš„ [ItemComponents](https://wiki.bedrock.dev/items/item-components.html) æ–‡æ¡£ï¼

ä»¥å…è®¸å‰¯æ‰‹ä¸¾ä¾‹ã€‚

åœ¨ Nukkit-MOT çš„ [CustomItemDefinition](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/item/customitem/CustomItemDefinition.java#L203) ç±»ä¸­çš„å†…å®¹å¦‚ä¸‹

```java
public class CustomItemDefinition {
    public static class SimpleBuilder {
        /**
         * æ˜¯å¦å…è®¸å‰¯æ‰‹æŒæœ‰
         */
        public SimpleBuilder allowOffHand(boolean allowOffHand) {
            this.nbt.getCompound("components")
                    .getCompound("item_properties")
                    .putBoolean("allow_off_hand", allowOffHand);
            return this;
        }
    }
}
```

è€Œ Bedrock Wiki ä¸­æ˜¯è¿™ä¹ˆä»‹ç» [Allow Off Hand](https://wiki.bedrock.dev/items/item-components.html#allow-off-hand) çš„ï¼š

```md
## Allow Off Hand

Determines whether an item can be placed in the off-hand slot of the inventory.
```
```java title="minecraft:item > components"
"minecraft:allow_off_hand": {
    "value": true
}
```

SimpleBuilder#allowOffHand æ–¹æ³•ä¸­çš„ `this.nbt` åœ¨æ„å»ºå™¨ä¸­è¢«åˆ›å»ºï¼Œå¯å‚è€ƒ Nukkit-MOT çš„ [CustomItemDefinition.java#L171](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/item/customitem/CustomItemDefinition.java#L171)

```java
    public static class SimpleBuilder {
        protected final CompoundTag nbt = new CompoundTag()
                .putCompound("components", new CompoundTag()
                        .putCompound("item_properties", new CompoundTag()
                                .putCompound("minecraft:icon", new CompoundTag())
                        )
                );
    }
```

:::note

å¹¶ä¸æ˜¯æ‰€æœ‰æ–¹æ³•éƒ½èƒ½é€šè¿‡ç®€å•çš„æ·»åŠ  nbt å°±è¾¾æˆå…¶æ•ˆæœçš„ï¼Œè­¬å¦‚ `minecraft:cooldown` å°±éœ€è¦æœåŠ¡å™¨æ¥å¤„ç† `PlayerStartItemCoolDownPacket` ä»¥å®ç°ç‰©å“çš„ä½¿ç”¨å†·å´è¡Œä¸ºã€‚

å¯ä»¥åœ¨ [cn.nukkit.network.protocol.ProtocolInfo](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/network/protocol/ProtocolInfo.java) ä¸­æŸ¥çœ‹åè®®æ”¯æŒçš„æ‰€æœ‰æ•°æ®åŒ…ã€‚

:::

### RenderOffsets æ¸²æŸ“åç§» \{#render-offsets}

æ¸²æŸ“åç§»çš„çŸ¥è¯†è¾ƒä¸ºåºå¤§ã€å¤æ‚ï¼Œå½“å‰ä¹Ÿæ²¡æœ‰å¯è§†åŒ–å·¥å…·æ‰€ä»¥éœ€è¦ä¸€å®šçš„ç©ºé—´æƒ³è±¡èƒ½åŠ›ã€‚

å¼•ç”¨ï¼š

- [cn.nukkit.item.customitem.data.RenderOffsets](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/item/customitem/data/RenderOffsets.java)
- [cn.nukkit.item.customitem.data.Offset](https://github.com/MemoriesOfTime/Nukkit-MOT/blob/master/src/main/java/cn/nukkit/item/customitem/data/Offset.java)


é€šè¿‡è§‚å¯Ÿä¸‹é¢çš„é«˜äº®éƒ¨åˆ†ä»£ç å¯çŸ¥ï¼Œéœ€è¦å‘ `RenderOffsets` ç±»ä¼ å…¥ 4 ä¸ª `Offset` å¯¹è±¡ã€‚

```java title="cn.coolloong.amethyst_equipment.Item.AmethystSpear èŠ‚é€‰"
    @Override
    public CustomItemDefinition getDefinition() {
        return CustomItemDefinition
                .toolBuilder(this, ItemCreativeCategory.EQUIPMENT)
                .addRepairItems(List.of(Item.fromString("minecraft:amethyst_shard")), 100)
                .addRepairItems(List.of(Item.fromString("yes:amethyst_spear")), 400)
                .renderOffsets(new RenderOffsets(
                    // highlight-start
                                Offset.builder()
                                        .position(0.48f, -0.128f, -0.946f)
                                        .rotation(11.696f, -64.536f, 79.413f)
                                        .scale(0.038f, 0.037f, 0.038f),
                                Offset.builder()
                                        .position(0.258f, 0.979f, -0.541f)
                                        .rotation(-63.268f, -43.969f, 144.041f)
                                        .scale(0.094f, 0.094f, 0.094f),
                                Offset.builder()
                                        .position(-1.053f, 0.136f, -0.803f)
                                        .rotation(27.273f, 67.731f, -64.494f)
                                        .scale(0.063f, 0.063f, 0.063f),
                                Offset.builder()
                                        .position(0.258f, 0.979f, -0.541f)
                                        .rotation(-63.268f, -43.969f, 144.041f)
                                        .scale(0.094f, 0.094f, 0.094f)
                        )
                    // highlight-end
                )
                .creativeGroup("itemGroup.name.sword")
                .allowOffHand(false)
                .handEquipped(true)
                .customBuild(nbt -> {
                    nbt.getCompound("components")
                            .putCompound("minecraft:cooldown", new CompoundTag()
                                    .putString("category", "amethyst_spear")
                                    .putFloat("duration", 3f))
                            .getCompound("item_properties").putBoolean("animates_in_toolbar", true)
                            .getCompound("item_properties").putInt("use_duration", 640);
                });
    }
```

åœ¨ RenderOffsets ç±»çš„å®šä¹‰ä¸­

```java
public RenderOffsets(@Nullable Offset mainHandFirstPerson, @Nullable Offset mainHandThirdPerson, @Nullable Offset offHandFirstPerson, @Nullable Offset offHandThirdPerson) {}
```

å¯ä»¥çŸ¥é“å››ä¸ªå‚æ•°åˆ†åˆ«ä¸ºï¼š

- mainHandFirstPerson: ä¸»æ‰‹ç¬¬ä¸€äººç§°
- mainHandThirdPerson: ä¸»æ‰‹ç¬¬ä¸‰äººç§°
- offHandFirstPerson: å‰¯æ‰‹ç¬¬ä¸€äººç§°
- offHandThirdPerson: å‰¯æ‰‹ç¬¬ä¸‰äººç§°

éœ€è¦æ›´å¤šçš„å‘ç°...